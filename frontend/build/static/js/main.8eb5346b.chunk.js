(this["webpackJsonpdeadline-app"]=this["webpackJsonpdeadline-app"]||[]).push([[0],{33:function(e,t,n){},35:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),i=n.n(s),o=n(21),c=n.n(o),r=(n(33),n(22)),l=n(10),d=n(4),u=n.n(d),b=n(3),j=n(8),m=n(9),h=n(23),p=n(24),f=n(27),O=n(26),x=(n(35),n(25)),v=n.n(x).a.create({baseURL:"https://tamk-4a00ez62-3001-group11.herokuapp.com/api"});var S=function(e){var t="3",n="2",s="1",i=function(t){e.onInputChange(t)},o=function(t){return e.todoFormState.priority.toString()===t};return Object(a.jsxs)("form",{children:[Object(a.jsx)("h3",{children:"Add Deadline"}),Object(a.jsxs)("div",{className:"input-animation",children:[Object(a.jsx)("input",{onChange:i,name:"name",value:e.todoFormState.name,type:"text",required:!0}),Object(a.jsx)("label",{htmlFor:"name",className:"label-name",children:Object(a.jsx)("span",{className:"content-name",children:"Name"})})]}),Object(a.jsxs)("div",{className:"input-animation",children:[Object(a.jsx)("input",{onChange:i,name:"date",type:"date",value:e.todoFormState.date,required:!0}),Object(a.jsx)("label",{htmlFor:"date",className:"label-name",children:Object(a.jsx)("span",{className:"content-name",children:"Date"})})]}),Object(a.jsx)("div",{id:"priority",children:Object(a.jsxs)("label",{children:["Priority",Object(a.jsxs)("div",{className:"radio-container",children:[Object(a.jsx)("input",{type:"radio",id:"low",name:"priority",value:t,checked:o(t),onChange:i}),Object(a.jsx)("label",{htmlFor:"low",className:"radio",children:"Low"}),Object(a.jsx)("input",{type:"radio",id:"medium",name:"priority",value:n,checked:o(n),onChange:i}),Object(a.jsx)("label",{htmlFor:"medium",className:"radio",children:"Medium"}),Object(a.jsx)("input",{type:"radio",id:"high",name:"priority",value:s,checked:o(s),onChange:i}),Object(a.jsx)("label",{htmlFor:"high",className:"radio",children:"High"})]})]})}),Object(a.jsxs)("div",{className:"input-animation",children:[Object(a.jsx)("input",{onChange:i,name:"list",type:"text",value:e.todoFormState.list,required:!0}),Object(a.jsx)("label",{htmlFor:"list",className:"label-name",children:Object(a.jsx)("span",{className:"content-name",children:"Task List"})})]}),Object(a.jsxs)("div",{className:"input-animation",children:[Object(a.jsx)("input",{onChange:i,name:"description",type:"text",value:e.todoFormState.description,required:!0}),Object(a.jsx)("label",{htmlFor:"description",className:"label-name",children:Object(a.jsx)("span",{className:"content-name",children:"Description"})})]}),Object(a.jsxs)("div",{className:"submitbuttons",children:[Object(a.jsx)("button",{onClick:function(t){t.preventDefault(),""!==e.todoFormState.name&&e.onFormSubmit(e.todoFormState)},id:"submit",className:"form-button",type:"submit",children:e.submitButtonLabel}),Object(a.jsx)("button",{onClick:function(t){t.preventDefault(),e.onFormCancel()},id:"cancel",className:"form-button",type:"submit",children:"Cancel"})]})]})},k=n(6),y=n(12),g=n.n(y);var N=function(e){var t={main:{display:"flex",flexFlow:"row wrap"},header:{width:"100%"},content:{width:"100%"}},n={width:"100%",height:"100%",transform:e.isOpen?"rotate(90deg)":"",transition:"all 0.1s ease-out"};return Object(a.jsxs)("div",{className:"collapsible",style:t.main,children:[Object(a.jsxs)("div",{className:"collapsible-header",onClick:function(){e.onClick(e.id)},style:t.header,children:[Object(a.jsx)("div",{style:{textAlign:"center",width:"16px",height:"16px",marginRight:"1rem"},children:Object(a.jsx)("i",{className:"fas fa-angle-right",style:n})}),e.header]}),Object(a.jsx)("div",{className:e.isOpen?"collapsible-content":"collapsible-content collapsed",style:t.content,children:e.isOpen?e.children:null})]})};function C(e){return Object(a.jsxs)("button",{id:e.id,className:e.className,onClick:e.onClick,children:[e.label,Object(a.jsx)("i",{className:e.icon})]})}var w=function(e){var t=e.todo,n=e.todoHandler,s=e.collapsibleStates,i=function(){return g()(t.date).diff(g()(new Date),"days")};return Object(a.jsx)("li",{className:t.isdone?"todo-item completed":"todo-item",children:Object(a.jsxs)(N,{id:t.id,isOpen:s.find((function(e){return e.id===t.id})).isOpen,onClick:n.collapse,header:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{className:"todo-priority",children:t.priority}),Object(a.jsx)("p",{className:"todo-date",children:t.date}),Object(a.jsx)("p",{className:"todo-name",children:t.name}),Object(a.jsx)(C,{className:"btn-flat task-completed",onClick:function(e){e.stopPropagation(),n.complete(t.id)},icon:"fas fa-check"})]}),children:[Object(a.jsxs)("div",{className:"toolbar",children:[Object(a.jsx)("p",{children:t.isdone?"Task completed":t.date?i()>=0?"Time remaining: ".concat(i()," days"):"You are ".concat(-i()," days late!"):"You are in no hurry"}),Object(a.jsx)(C,{id:"edit",className:"btn py-05",onClick:function(){n.edit(t)},label:"Edit",icon:"fas fa-edit"}),Object(a.jsx)(C,{id:"delete",className:"btn py-05",onClick:function(){n.delete(t.id)},label:"Delete",icon:"fas fa-trash"})]}),""===t.description?null:Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:"Description:"}),Object(a.jsx)("p",{className:"todo-description",children:t.description})]}),Object(a.jsx)("div",{children:Object(a.jsxs)("p",{className:"todo-datecreated",children:["Date added: ",t.created]})})]})})},F=function(e){var t=e.todos,n=e.todoHandler,s=e.collapsibleStates,i=t.map((function(e){return Object(a.jsx)(w,{todo:e,todoHandler:n,collapsibleStates:s},e.id)}));return Object(a.jsx)("div",{className:"list",children:i})},L=function(e){var t=e.deadlines,n=e.todoHandler,s=e.collapsibleStates,i=t.map((function(e){return Object(a.jsx)(w,{todo:e,todoHandler:n,collapsibleStates:s},e.id)}));return Object(a.jsx)("div",{children:i})},E=function(e){var t=e.todos,n=e.lists,i=e.todoHandler,o=e.collapsibleStates,c=e.isLoaded,r=e.statusMessage,l=Object(s.useState)([]),d=Object(k.a)(l,2),u=d[0],j=d[1],m=Object(s.useState)(!1),h=Object(k.a)(m,2),p=h[0],f=h[1];Object(s.useEffect)((function(){var e;e=n.map((function(e){return e={id:e.id,isOpen:!1}})),j(e)}),[n]);var O=[];t.forEach((function(e){O.includes(e.list)||O.push(e.list)}));var x=function(e){return n.find((function(t){return t.name.toLowerCase()===e.toLowerCase()})).id},v=function(e){var t=Object(b.a)(u),n=t.findIndex((function(t){return t.id===e}));t[n].isOpen=!t[n].isOpen,j(t)},S=function(e){return u.find((function(t){return t.id===x(e)})).isOpen},y=O.map((function(e){if("deadlines"!==e){var n=t.filter((function(t){return t.list===e&&"deadlines"!==t.list}));return p&&(n=n.filter((function(e){return!e.isdone}))),Object(a.jsx)("ul",{children:Object(a.jsx)(N,{id:x(e),header:Object(a.jsx)("h3",{children:e}),onClick:v,isOpen:S(e),children:Object(a.jsx)(F,{todos:n,todoHandler:i,collapsibleStates:o})})},x(e))}return""}));return c?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"list-toolbar",children:[Object(a.jsx)("button",{className:"btn-alt",onClick:function(e){var t=Object(b.a)(u);t.forEach((function(e){e.isOpen=!0})),j(t)},children:"Expand all lists"}),Object(a.jsx)("button",{className:"btn-alt",onClick:function(e){var t=Object(b.a)(u);t.forEach((function(e){e.isOpen=!1})),j(t)},children:"Collapse all lists"}),Object(a.jsx)("div",{className:"hide-completed-toggle",children:Object(a.jsxs)("label",{className:"checbox-wrapper",children:[Object(a.jsx)("i",{className:p?"fas fa-check-square":"fas fa-square"}),Object(a.jsx)("input",{type:"checkbox",checked:p,onChange:function(e){f(e.target.checked)}}),"Hide completed"]})})]}),Object(a.jsxs)("div",{className:"list",children:[Object(a.jsxs)("div",{className:"deadlines",children:[Object(a.jsx)("h3",{children:"Deadlines"}),Object(a.jsx)(L,{deadlines:t.filter((function(e){return"deadline"===e.list||"deadlines"===e.list})),todoHandler:i,collapsibleStates:o})]}),y]})]}):Object(a.jsx)("div",{className:"list",children:r})},D="Completed",T="Date",_="Name",R="Priority";function H(e){return Object(a.jsx)("button",{className:"btn py-05",onClick:function(t){e.onClick(e.label)},children:e.label})}var I=function(e){var t=Object(s.useState)(!0),n=Object(k.a)(t,2),i=n[0],o=n[1],c=Object(s.useState)(null),r=Object(k.a)(c,2),l=r[0],d=r[1],u=e.tasklist.slice(),b=e.updateTasklist;Object(s.useEffect)((function(){u.sort((function(e,t){if(e.list!==t.list)return e.list.localeCompare(t.list);switch(l){case T:return i?(null===e.date)-(null===t.date)||new Date(e.date)-new Date(t.date):(null===t.date)-(null===e.date)||new Date(t.date)-new Date(e.date);case _:return i?e.name.localeCompare(t.name):t.name.localeCompare(e.name);case R:return i?(0===e.priority)-(0===t.priority)||e.priority-t.priority:(0===t.priority)-(0===e.priority)||t.priority-e.priority;case D:return i?t.isdone-e.isdone:e.isdone-t.isdone;default:return 0}})),b(u)}),[i,l,b]);var j=function(e){o(e!==l||!i),d(e)};return Object(a.jsx)("div",{children:Object(a.jsxs)("ul",{className:"sortbuttonlist",children:["Sort by:",Object(a.jsx)("li",{children:Object(a.jsx)(H,{label:"Date",onClick:j})}),Object(a.jsx)("li",{children:Object(a.jsx)(H,{label:"Name",onClick:j})}),Object(a.jsx)("li",{children:Object(a.jsx)(H,{label:"Priority",onClick:j})}),Object(a.jsx)("li",{children:Object(a.jsx)(H,{label:"Completed",onClick:j})})]})})},W="Add",B="Edit",M="deadlines",V=1050,q=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).handleInitialFetch=function(e,t){v.get("/".concat("".concat(e,"?apikey=").concat("43457514"))).then((function(e){if(!e.hasOwnProperty("data"))throw new Error("Data fetching failed.");t(e)})).catch((function(t){a.handleFetchError(t,(function(){var t="isLoaded_".concat(e);a.setState(Object(m.a)({},t,!0))}))}))},a.handleFetchError=function(e,t){e.response&&404===e.response.status?t():a.setState({statusMessage:"ERROR: Could not reach the api"})},a.convertTodoContext=function(e){var t=e.hasOwnProperty("date")?"frontend":"backend";if("frontend"===t){var n={date_deadline:""!==e.date?e.date:null,name:e.name,description:e.description,priority:+e.priority,is_done:e.isdone};return e.listid&&(n.listid=e.listid),e.created&&(n.date_created=e.created),e.id&&(n.id=e.id),n}return"backend"===t?{id:e.id,name:e.name,date:e.date_deadline,priority:e.priority,listid:e.listid,list:a.getListName(e.listid),description:e.description,isdone:e.is_done,created:e.date_created}:e},a.getListId=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(b.a)(a.state.lists),""===t&&(t=M),!(s=n.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))){e.next=7;break}return e.abrupt("return",s.id);case 7:return e.prev=7,e.next=10,v.post("/lists?apikey=".concat("43457514"),{name:t});case 10:return i=e.sent,e.abrupt("return",i.data.content.id);case 14:e.prev=14,e.t0=e.catch(7),console.log(e.t0.response);case 17:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(t){return e.apply(this,arguments)}}(),a.getListName=function(e){return Object(b.a)(a.state.lists).find((function(t){return t.id===e})).name},a.isLastTodoFromList=function(e){return 0===a.state.todos.filter((function(t){return t.list===e.list})).length},a.handleTodoFormInputChange=function(e){var t=e.target,n=t.value,s=t.name,i=Object(l.a)({},a.state.todoFormState);i[s]=n,a.setState({todoFormState:i})},a.handleSubmit=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,s,i,o,c,r,l,d,j,m,h,p,f,O;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(b.a)(a.state.todos),s=Object(b.a)(a.state.lists),i=Object(b.a)(a.state.collapsibleStates),window.innerWidth<V&&a.setState({isFormVisibleWhenScreenSmall:!1}),e.prev=4,e.next=7,a.getListId(t.list);case 7:if(o=e.sent,(c=a.convertTodoContext(t)).listid=o,a.state.todoFormSubmitButtonLabel!==B){e.next=28;break}return r=n.findIndex((function(e){return e.id===t.id})),e.next=14,v.put("/todos/".concat(t.id,"?apikey=").concat("43457514"),c);case 14:if(200!==e.sent.status){e.next=25;break}if(""===t.list&&(t.list=M),s.includes({id:c.listid,name:t.list})){e.next=22;break}return e.next=20,v.get("/lists?apikey=".concat("43457514"));case 20:l=e.sent,a.setState({lists:l.data});case 22:n[r]=t,e.next=26;break;case 25:throw new Error("ERROR: Could not update entry in db.");case 26:e.next=46;break;case 28:return e.next=30,v.post("/todos?apikey=".concat("43457514"),c);case 30:if(d=e.sent,j=d.data.content.id,m={id:j,isOpen:!1},i=i.concat(m),s.includes({id:c.listid,name:t.list})){e.next=39;break}return e.next=37,v.get("/lists?apikey=".concat("43457514"));case 37:h=e.sent,a.setState({lists:h.data});case 39:return e.next=41,v.get("/todos/".concat(j,"?apikey=").concat("43457514"));case 41:p=e.sent,f=p.data[0],O=a.convertTodoContext(f),n=n.concat(O),console.log(O);case 46:e.next=52;break;case 48:e.prev=48,e.t0=e.catch(4),console.log(e.t0),console.log(e.t0.response);case 52:a.setState({todos:n,todoFormState:a.resetTodoFormState(),todoFormSubmitButtonLabel:W,collapsibleStates:i});case 53:case"end":return e.stop()}}),e,null,[[4,48]])})));return function(t){return e.apply(this,arguments)}}(),a.handleCancel=function(){window.innerWidth<V&&a.setState({isFormVisibleWhenScreenSmall:!1}),a.setState({todoFormState:a.resetTodoFormState(),todoFormSubmitButtonLabel:W})},a.resetTodoFormState=function(){var e={name:"",date:"",priority:"",list:"",description:"",isdone:!1};return e},a.handleSort=function(e){a.setState({todos:e})},a.getTodoObject=function(e){var t=a.state.todos.filter((function(t){return t.id===e}));return console.log(t),t[0]},a.todoHandler={collapse:function(e){var t=Object(b.a)(a.state.collapsibleStates);t.forEach((function(t){t.isOpen=e===t.id&&!t.isOpen})),a.setState({collapsibleStates:t})},delete:function(){var e=Object(j.a)(u.a.mark((function e(t){var n,s,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.getTodoObject(t),e.prev=1,e.next=4,v.delete("todos/".concat(t,"?apikey=").concat("43457514"));case 4:if(204!==e.sent.status){e.next=24;break}if(s=a.state.todos.filter((function(e){return e.id!==t})),a.setState({todos:s}),"deadlines"===n.list){e.next=22;break}if(!a.isLastTodoFromList(n)){e.next=22;break}return e.next=12,a.getListId(n.list);case 12:return i=e.sent,e.next=15,v.delete("lists/".concat(i,"?apikey=").concat("43457514"));case 15:if(204!==e.sent.status){e.next=21;break}o=a.state.lists.filter((function(e){return e.id!==i})),a.setState({lists:o}),e.next=22;break;case 21:throw new Error("ERROR: Could not delete list with id: ".concat(i," from db."));case 22:e.next=25;break;case 24:throw new Error("ERROR: Could not delete todo with id: ".concat(t," from db."));case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(1),console.log(e.t0);case 30:case"end":return e.stop()}}),e,null,[[1,27]])})));return function(t){return e.apply(this,arguments)}}(),complete:function(){var e=Object(j.a)(u.a.mark((function e(t){var n,s,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.getTodoObject(t),s={},n.isdone?s.is_done=!1:s.is_done=!0,e.prev=3,e.next=6,v.put("todos/".concat(t,"?apikey=").concat("43457514"),s);case 6:if(200!==e.sent.status){e.next=14;break}i=Object(b.a)(a.state.todos),o=i.findIndex((function(e){return e.id===t})),i[o]=Object(l.a)(Object(l.a)({},i[o]),{},{isdone:!i[o].isdone}),a.setState({todos:i}),e.next=15;break;case 14:throw new Error("Error: Could not mark todo done with id: ".concat(t," in db."));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),edit:function(e){window.innerWidth<V&&a.setState({isFormVisibleWhenScreenSmall:!0}),a.setState({todoFormState:e,todoFormSubmitButtonLabel:B})}},a.state={isLoaded_lists:!1,isLoaded_todos:!1,isLoaded:!1,statusMessage:"Fetching data...",todos:[],lists:[],todoFormState:{name:"",date:"",priority:"",list:"",descritpion:"",isdone:!1},todoFormSubmitButtonLabel:W,collapsibleStates:[],isFormVisibleWhenScreenSmall:!1},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){for(var e=this,t=function(){var t=a[n];e.handleInitialFetch(t,(function(n){switch(t){case"lists":e.setState({lists:n.data,isLoaded_lists:!0});break;case"todos":var a,s=n.data.map((function(t){return e.convertTodoContext(t)})),i=Object(b.a)(e.state.collapsibleStates),o=Object(r.a)(s);try{for(o.s();!(a=o.n()).done;){var c={id:a.value.id,isOpen:!1};i=i.concat(c)}}catch(l){o.e(l)}finally{o.f()}e.setState({todos:s,collapsibleStates:i,isLoaded_todos:!0});break;default:console.log("Something went wrong.")}}))},n=0,a=["lists","todos"];n<a.length;n++)t()}},{key:"componentDidUpdate",value:function(){this.state.isLoaded_todos&&this.state.isLoaded_lists&&!this.state.isLoaded&&this.setState({isLoaded:!0})}},{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{className:"container",children:Object(a.jsxs)("div",{className:"app",children:[Object(a.jsx)("button",{className:this.state.isFormVisibleWhenScreenSmall?"floating-action-button fab-hidden":"floating-action-button fab-visible",onClick:function(){e.setState({isFormVisibleWhenScreenSmall:!0})},children:Object(a.jsx)("i",{className:"fas fa-plus"})}),Object(a.jsx)("div",{className:this.state.isFormVisibleWhenScreenSmall?"form form-visible":"form form-hidden",children:Object(a.jsx)(S,{submitButtonLabel:this.state.todoFormSubmitButtonLabel,todoFormState:this.state.todoFormState,onInputChange:this.handleTodoFormInputChange,onFormSubmit:this.handleSubmit,onFormCancel:this.handleCancel})}),Object(a.jsxs)("div",{className:this.state.isFormVisibleWhenScreenSmall?"todo-list list-hidden":"todo-list list-visible",children:[Object(a.jsx)(I,{tasklist:this.state.todos,updateTasklist:this.handleSort}),Object(a.jsx)(E,{todos:this.state.todos,lists:this.state.lists,todoHandler:this.todoHandler,collapsibleStates:this.state.collapsibleStates,isLoaded:this.state.isLoaded,statusMessage:this.state.statusMessage})]})]})})}}]),n}(i.a.Component);c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(q,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.8eb5346b.chunk.js.map